(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{1250:function(e,t,n){var r=n(1251);"string"==typeof r&&(r=[[e.i,r,""]]);var a={hmr:!0,transform:void 0,insertInto:void 0};n(56)(r,a);r.locals&&(e.exports=r.locals)},1251:function(e,t,n){(e.exports=n(55)(!1)).push([e.i,'.rjsf #root_rgpd {\r\n  margin-right: 6px;\r\n}\r\n\r\n.rjsf input[type="checkbox"],\r\n.rjsf input[type="radio"] {\r\n  margin-right: 6px;\r\n}\r\n\r\n.radius-border-input-email input {\r\n  border-bottom-right-radius: 0;\r\n  border-top-right-radius: 0;\r\n}\r\n\r\n.rjsf.form-newsletter {\r\n  display: flex;\r\n  flex: 1;\r\n  flex-direction: column;\r\n}\r\n\r\ndiv.field-error.has-error.has-danger .form-control {\r\n  border-color: var(--danger);\r\n  border-width: 1px;\r\n}\r\n\r\n.we-dropdown-item.we-disabled {\r\n  pointer-events: none;\r\n}\r\n\r\n.wifeo-form-custom [contenteditable]:focus {\r\n  outline: 0px solid transparent;\r\n}\r\n.wifeo-form-custom textarea {\r\n  resize: none;\r\n}\r\n',""])},1252:function(e,t,n){var r=n(1253);"string"==typeof r&&(r=[[e.i,r,""]]);var a={hmr:!0,transform:void 0,insertInto:void 0};n(56)(r,a);r.locals&&(e.exports=r.locals)},1253:function(e,t,n){(e.exports=n(55)(!1)).push([e.i,".icon-actions-form {\r\n  width: 36px;\r\n  text-align: center;\r\n}\r\n\r\n.hidden-title label.control-label {\r\n  visibility: hidden;\r\n}\r\n\r\n/* Extra small devices (phones, less than 768px) */\r\n/* .width-form-custom {\r\n  width: 60%;\r\n} */\r\n\r\n/* Small devices (tablets, 768px and up) */\r\n/* @media (min-width: 768px) { ... } */\r\n\r\n/* Medium devices (desktops, 992px and up) */\r\n/* @media (min-width: 992px) {\r\n  .width-form-custom {\r\n    width: 66%;\r\n  }\r\n} */\r\n\r\n/* Large devices (large desktops, 1200px and up) */\r\n/* @media (min-width: 1200px) {\r\n  .width-form-custom {\r\n    width: 76%;\r\n  }\r\n} */\r\n",""])},1260:function(e,t,n){"use strict";n.r(t);var r=n(0),a=n.n(r),o=n(48),i=n(214),l=n.n(i),s=n(9),c=n.n(s),u=n(39),m=n.n(u),d=n(52);function p(e){return(p="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function f(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function h(e,t){return(h=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function b(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=g(e);if(t){var a=g(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return v(this,n)}}function v(e,t){return!t||"object"!==p(t)&&"function"!=typeof t?y(e):t}function y(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function g(e){return(g=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function S(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var E=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&h(e,t)}(i,e);var t,n,r,o=b(i);function i(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,i),S(y(t=o.call(this,e)),"handleMouseLeave",(function(){t.setState({ratingPreview:0})})),S(y(t),"handleMouseOver",(function(e){t.setState({ratingPreview:e+1})})),S(y(t),"handleClick",(function(e){var n=t.props.onChange;t.setState({rating:e+1,ratingPreview:0},(function(){n(e+1)}))})),t.state={stars:new Array(5).fill(5),rating:0,ratingPreview:0},t}return t=i,(n=[{key:"render",value:function(){var e=this,t=this.state,n=t.stars,r=t.rating,o=t.ratingPreview;return a.a.createElement("span",{className:"mr-2 wrapper-stars",onMouseLeave:function(){return e.handleMouseLeave()}},n.map((function(t,n){return r&&n<r||o&&n<o?a.a.createElement("i",{key:n,className:"fas fa-star ".concat("fa-2x cursor-pt"),onMouseOver:function(){return e.handleMouseOver(n)},onClick:function(){return e.handleClick(n)}}):a.a.createElement("i",{key:n,className:"far fa-star ".concat("fa-2x cursor-pt"),onMouseOver:function(){return e.handleMouseOver(n)}})})))}}])&&f(t.prototype,n),r&&f(t,r),i}(r.PureComponent),w=n(581),k=n.n(w),x=n(70);var F=c.a._css,O=function(e){var t=e.prefixCss,n=e.mode,r=e.onAction,o=e.useMarginT,i=e.style,l=e.btnCss,s=e.pendingSend,c=e.cta,u=e.btnAlign;if(l&&(c.class=c.class+" "+l),s)return a.a.createElement("i",{className:"fas fa-spinner fa-pulse"});var m,p,f,h="text-center";return"right"===u?h="text-right":"left"===u&&(h="text-left"),a.a.createElement("div",(m={className:!1!==o?"mt-2":""},p="className",f=F("",!1!==o&&"mt-2",h),p in m?Object.defineProperty(m,p,{value:f,enumerable:!0,configurable:!0,writable:!0}):m[p]=f,m),a.a.createElement(d.a,{prefixCss:t,mode:n,cta:c,style:i,onAction:r}))},N=n(19),_=n.n(N);n(1252);function C(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(e)))return;var n=[],r=!0,a=!1,o=void 0;try{for(var i,l=e[Symbol.iterator]();!(r=(i=l.next()).done)&&(n.push(i.value),!t||n.length!==t);r=!0);}catch(e){a=!0,o=e}finally{try{r||null==l.return||l.return()}finally{if(a)throw o}}return n}(e,t)||I(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function M(e){return function(e){if(Array.isArray(e))return j(e)}(e)||function(e){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(e))return Array.from(e)}(e)||I(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function I(e,t){if(e){if("string"==typeof e)return j(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?j(e,t):void 0}}function j(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function A(){return(A=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e}).apply(this,arguments)}function q(e){return(q="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function T(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?Object(arguments[t]):{},r=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(n).filter((function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable})))),r.forEach((function(t){V(e,t,n[t])}))}return e}function P(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function R(e,t){return(R=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function L(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=U(e);if(t){var a=U(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return B(this,n)}}function B(e,t){return!t||"object"!==q(t)&&"function"!=typeof t?J(e):t}function J(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function U(e){return(U=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function V(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var D,z=c.a._Popup,W=c.a._loadScript,H=(c.a._debounce,c.a._store.getEnv()),X=H.scheme,G=H.domain,Q=H.subdomain,Z=H.apiProd,$=H.domainApi,K=Z?$:G,Y=Z?Q:"form",ee=("".concat(X,"://").concat(Y,".").concat(K).replace("__API__","form"),m.a.CancelToken),te=c.a._css;n(1250);var ne=c.a._reactSortableHoc,re=(ne.SortableContainer,ne.SortableItem,ne.arrayMove),ae=(ne.sortableHandle,function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&R(e,t)}(s,e);var t,n,r,i=L(s);function s(e){var t;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,s),V(J(t=i.call(this,e)),"onSortEnd",(function(e){var n=e.oldIndex,r=e.newIndex;n!==r&&t.setState((function(e){var t=e.formItems;return{formItems:re(t,n,r)}}))})),V(J(t),"closeModal",(function(){t.setState({showSuccessMsg:!1,openedModal:!1}),t.props.onCloseModal()})),V(J(t),"renderMap",(function(e,n,r){var o=t.props,i=o.ui,l=o.onAction,s=o.mode,c=r||{width:"100%",height:"".concat(n||300,"px"),border:"0px"};return a.a.createElement("div",null,i.map&&e.src&&"iframe"===e.tpl&&a.a.createElement("div",{style:c,onClick:function(){l({action:"click_iframe"})}},a.a.createElement("iframe",{style:c,className:"embed-responsive-item d-block",src:e.src,allowtransparency:"true",allowFullScreen:!0})),e.src&&"img"===e.tpl&&a.a.createElement("div",null,a.a.createElement("div",{className:"d-flex align-items-center"},a.a.createElement(x.a,{item:e,cfgToolbar:{},onAction:function(e){return console.log(e)},mode:s}))))}));var n=JSON.parse(JSON.stringify(e.schema)),r={},o={};e.autoAddUi&&(r={ratingWidget:E,captcha:le},o={recaptcha:{"ui:widget":"captcha","ui:options":{label:!1}},Note:{"ui:widget":"ratingWidget"},"ui:order":["Email","*"]},n.properties.Nom&&o["ui:order"].unshift("Nom"));var l=(t.props.blocks.find((function(e){return"media"===e.name}))||{item:null}).item;e.addEmail&&(localStorage.getItem("currentUser")&&"edit"!==e.mode?(o["ui:order"]=o["ui:order"].filter((function(e){return"Email"!==e})),n.properties.Email&&(delete n.properties.Email,n.required=n.required.filter((function(e){return"Email"!==e})))):n.required.find((function(e){return"Email"===e}))||(n.required.push("Email"),n.properties.Email={type:"string",format:"email",title:"Email"}));return t.state={schema:n,widgets:r,uiSchema:T({},e.uiSchema,o),error:null,item:l||null,bearer:{},isLoaded:!1,pathGet:e.url,pathSave:e.urlSave,cancelToken:null,keyForm:1,cta:(e.blocks.find((function(e){return"cta"===e.name}))||{cta:null}).cta,mepRender:{full:function(e,n,r,a){return t.mepFull(!1,e,n,r,a)},"full-reverse":function(e,n,r,a){return t.mepFull(!0,e,n,r,a)},stack:function(e,n,r,a){return t.mepStack(!1,e,n,r,a)},"stack-reverse":function(e,n,r,a){return t.mepStack(!0,e,n,r,a)},"only-map":function(e,n,r,a){return t.mepOnlyMap(e,r)}},pendingSend:!1,showSuccessMsg:!1,openedModal:!1,loadingFailed:!0,forms:[],formItems:t.initFormItems(e.formItems),idForm:1,idFormEdit:1,popoverIsOpen:!1},t.doValidation=t.doValidation.bind(J(t)),t.refBtnSubmit=a.a.createRef(),t.requestState=t.requestState.bind(J(t)),t.cleanStrings=t.cleanStrings.bind(J(t)),t.cleanFormItemsInState=t.cleanFormItemsInState.bind(J(t)),t.refPopup=a.a.createRef(),t.limitations={optionsByField:{max:15},fieldsByForm:{max:"FREE"!==window.__PLAN_SITE?20:10}},t}return t=s,(n=[{key:"exportData",value:function(){var e=[];for(var t in this.state.formItems){var n=this.state.formItems[t],r={label:n.label,required:n.required,name:n.name,helpText:n.helpText,placeholder:n.placeholder,className:n.className,options:n.options,multiple:n.multiple,type:n.type};e.push(r)}a=e,o=new FormData,Object.keys(a).forEach((function(e){return o.append(e,a[e])}));var a,o,i=this,l=this.state.bearer;m.a.post("http://form.wifeo.org/form/create",{items:e},{headers:{Authorization:l,"Content-Type":"application/json"}}).then((function(e){i.getFormulaires()})).catch((function(e){console.log(e)}))}},{key:"onAddressChange",value:function(e){var t="https://maps.google.fr/maps?f=q&source=s_q&hl=fr&geocode=&q="+encodeURI(e.target.value)+"&output=embed";this.setState({item:{src:t,address:e.target.value}}),this.props.onAction({action:"map_changed",params:this.state})}},{key:"postForm",value:function(e){var t=this,n=this.props,r=n.onSend,a=n.resourceId,o=n.idsChannels,i=o||[],l={data:e.formData,channels:i},s=(this.props.blocks.find((function(e){return"cta"===e.name}))||{cta:null}).cta;a&&(l.module_resource=a);var c={"Content-Type":"application/json"},u=localStorage.getItem("currentUser");u&&(c.Authorization="Bearer ".concat(u)),m.a.post(this.state.pathSave,l,{headers:c}).then((function(e){t.setState({pendingSend:!1,keyForm:t.state.keyForm+1,showSuccessMsg:!0,openedModal:!0},(function(){r(),!0===t.props.redirection&&(s.newOnglet?window.open("".concat(s.link),"_blank"):location.href=s.link)}))})).catch((function(e){console.log(e)}))}},{key:"doValidation",value:function(e){var t=this;this.setState({pendingSend:!0},(function(){t.postForm(e)}))}},{key:"fetchForm",value:function(){var e=this;m.a.get(this.state.pathGet+"?no_cache=1",{cancelToken:new ee((function(e){D=e}))}).then((function(t){if(void 0!==JSON.parse(t.data.fields).schema)_.a.unstable_batchedUpdates((function(){e.setState({isLoaded:!0,loadingFailed:!1,schema:JSON.parse(t.data.fields).schema,formItems:JSON.parse(t.data.fields).formItems,uiSchema:JSON.parse(t.data.fields).uiSchema})}));else{var n=e.props.schema;localStorage.getItem("currentUser")&&"edit"!==e.props.mode?n.properties.Email&&(delete n.properties.Email,n.required=n.required.filter((function(e){return"Email"!==e}))):n.required.find((function(e){return"Email"===e}))||(n.required.unshift("Email"),n.properties.Email={type:"string",format:"email",title:"Email"}),_.a.unstable_batchedUpdates((function(){e.setState({isLoaded:!0,loadingFailed:!1,uiSchema:e.props.uiSchema,schema:n})}))}})).catch((function(t){e.setState({isLoaded:!0,loadingFailed:!0})}))}},{key:"componentDidMount",value:function(){var e=this;if(this.state.pathGet?this.props.integrated?this.props.staticForm?this.setState({isLoaded:!0,loadingFailed:!1,schema:this.props.staticForm.schema,formItems:this.props.staticForm.formItems,uiSchema:this.props.staticForm.uiSchema}):(console.log("Failed 1"),this.setState({loadingFailed:!0})):this.fetchForm():(console.log("Failed 2"),this.setState({loadingFailed:!0})),!this.props.externalCta){var t=this.state.cta;t&&(t.tpl="BtnBootstrapSubmit",t.onAction=function(t){e.refBtnSubmit.current&&e.refBtnSubmit.current.click()},W("https://www.google.com/recaptcha/api.js","js","recaptcha").then((function(){e.setState({cta:t})})))}}},{key:"componentWillMount",value:function(){}},{key:"componentWillUnmount",value:function(){D&&"function"==typeof D&&D()}},{key:"renderHiddenBtnSubmit",value:function(){return a.a.createElement("button",{ref:this.refBtnSubmit,type:"submit",className:"d-none"})}},{key:"renderBtnSubmit",value:function(e,t,n){var r=this.props,o=r.prefixCss,i=r.mode,l=r.onAction,s=this.state,c=s.cta,u=s.pendingSend;return n&&(c.class=c.class+" "+n),u?a.a.createElement("i",{className:"fas fa-spinner fa-pulse"}):a.a.createElement("div",{className:!1!==e?"mt-2":""},a.a.createElement(d.a,{prefixCss:o,mode:i,cta:c,style:t,onAction:l}))}},{key:"requestState",value:function(){var e=this.state,t=(e.schema,e.uiSchema,e.widgets,e.showErrorRecaptcha,e.loadingFailed),n=e.isLoaded;return a.a.createElement("div",null,n&&t&&a.a.createElement("div",{align:"center"},a.a.createElement("i",{className:"fa fa-times"}),a.a.createElement("span",null,"   Formulaire introuvable ou supprimé...")),t&&!n&&a.a.createElement("div",{align:"center"},a.a.createElement("i",{className:"fa fa-spinner fa-pulse fa-fw"}),a.a.createElement("span",null,"  Chargement en cours...")))}},{key:"mepFull",value:function(e,t,n,r,i){var l=this.props,s=(l.mode,l.prefixCss),c=(l.onAction,l.btnAlign),u=this.state,m=(u.schema,u.uiSchema,u.widgets,u.showErrorRecaptcha,u.loadingFailed);return a.a.createElement("div",{key:"mepFull"},!e&&r&&this.renderMap(r),a.a.createElement(o.a,A({title:t},this.props),a.a.createElement("div",{className:te(s,"row")},a.a.createElement("div",{className:te(s,"col-12 col-md-12",e&&"order-2")},a.a.createElement("div",null,!m&&this.renderForm(),!m&&a.a.createElement("div",{className:"text-right"},a.a.createElement(O,{cta:i,btnAlign:c})),this.requestState())))),e&&this.renderMap(r))}},{key:"renderForm",value:function(){var e,t=this,n=this.props,r=(n.ui,n.mode,this.state),o=r.schema,i=r.uiSchema,s=r.widgets;return r.showErrorRecaptcha,r.formItems,r.idFormEdit,r.idForm,r.popoverIsOpen,r.showSuccessMsg,r.openedModal,r.cta,r.isLoaded,!r.loadingFailed&&a.a.createElement(l.a,{schema:o,onError:(e="errors",console.log.bind(console,e)),onSubmit:this.doValidation,showErrorList:!1,liveValidate:!0,uiSchema:i,widgets:s,FieldTemplate:function(e){return a.a.createElement(oe,A({useOnlyUiTitle:"Contact"!==t.props.sectionTplName&&t.props.useOnlyUiTitle},e))}},this.renderHiddenBtnSubmit())}},{key:"mepOnlyMap",value:function(e,t){var n={},r="mx-auto",i=T({},this.props);return this.props.ui.mapFullWdithScreen&&(n={marginLeft:"-15px",marginRight:"-15px"},i.containerCss="container-fluid",r=""),a.a.createElement(o.a,A({key:"mepOnlyMap",title:e},i),a.a.createElement("div",{className:r,style:n},this.renderMap(t,null,{minHeight:"500px",border:"0px",width:"100%"})))}},{key:"initFormItems",value:function(e){var t=[];return this.props.addEmail?e.find((function(e){return"Email"===e.name}))||(t=[].concat(M(e),[{type:"email",labelMenu:"Email",label:"Email",className:"form-control",name:"Email",required:!0,placeholder:"email@example.com",helpText:"",minLength:1,maxLength:75}])):t=M(e),t}},{key:"cleanStrings",value:function(e){return"string"==typeof e?e.replace(/["]+/g,"'"):""}},{key:"getEnumFieldRJSF",value:function(e){var t=this;if(["radio","select"].indexOf(e.type)>=0)return e.options.map((function(e){return t.cleanStrings(e.label)}))}},{key:"getEnumCheckboxFieldRJSF",value:function(e){var t=this;return e.options.map((function(e){return t.cleanStrings(e.label)}))}},{key:"getTypeFieldRJSF",value:function(e){return{checkbox:"Case à cocher"===e.labelMenu?"boolean":"array",number:"number"}[e.type]||"string"}},{key:"getWidgetFieldRJSF",value:function(e){return{email:"email",date:"date",number:"updown",radio:"radio",checkbox:"Case à cocher"===e.labelMenu?"checkbox":"checkboxes",select:"select",text:"text",textarea:"textarea"}[e.type]||"text"}},{key:"buildSchema",value:function(){var e=this,t=this.props.ui,n={title:"",description:"",type:"object"},r=this.state.formItems,a={},o=[];return r.forEach((function(n){a[n.name]={},a[n.name].minLength=n.minLength,a[n.name].maxLength=n.maxLength;var r=null;if(n.options){var i=n.options.find((function(e){return!0===e.selected}));r=i&&i.label||void 0}r=e.cleanStrings(r),a[n.name].type=e.getTypeFieldRJSF(n),a[n.name].enum=e.getEnumFieldRJSF(n),a[n.name].title=e.cleanStrings(t.label&&n.label||""),"checkbox"===n.type&&("Case à cocher"===n.labelMenu?a[n.name].title=e.cleanStrings(n.options[0].label):(a[n.name].uniqueItems=!0,a[n.name].items={type:"string",enum:e.getEnumCheckboxFieldRJSF(n)})),"select"===n.type&&(a[n.name].default=r),"radio"===n.type&&(a[n.name].default=r),"number"===n.type&&(a[n.name].minimum=0),n.required&&o.push(n.name)})),n.properties=a,n.required=o,n}},{key:"buildUiSchema",value:function(){var e=this,t=this.props.ui,n={Message:{"ui:widget":"textarea"}},r=[];return this.state.formItems.forEach((function(a){n[a.name]={"ui:widget":e.getWidgetFieldRJSF(a),"ui:placeholder":e.cleanStrings(a.placeholder),"ui:help":e.cleanStrings(a.helpText),"ui:title":e.cleanStrings(t.label&&a.label||"")},r.push(a.name)})),r.push("*"),n["ui:order"]=r,n.testCheckbox={"ui:widget":"radio"},n}},{key:"mepStack",value:function(e,t,n,r,i){var l=this.props,s=(l.mode,l.prefixCss),c=(l.onAction,l.ui),u=this.state,m=(u.schema,u.uiSchema,u.widgets,u.showErrorRecaptcha,u.loadingFailed),d=(u.isLoaded,r&&r.src&&c.map);return a.a.createElement(o.a,A({key:"mepStack",title:t},this.props),a.a.createElement("div",{className:te(s,"row")},a.a.createElement("div",{className:te(s,"col-12","col-md-6",!d&&"mx-auto",e&&"order-2")},a.a.createElement("div",null,!m&&this.renderForm(),!m&&a.a.createElement(O,A({cta:i},this.props)),this.requestState())),d&&a.a.createElement("div",{className:te(s,"col-12 col-md-6",e&&"order-1")},this.renderMap(r))))}},{key:"integratedMep",value:function(e,t,n,r,o){var i=this.props,l=(i.mode,i.prefixCss),s=(i.onAction,i.ui),c=this.state,u=(c.schema,c.uiSchema,c.widgets,c.showErrorRecaptcha,c.loadingFailed),m=(c.isLoaded,r&&r.src&&s.map);return a.a.createElement("div",{className:te(l,"row")},a.a.createElement("div",{className:te(l,"col-12","col-md-6",!m&&"mx-auto",e&&"order-2")},a.a.createElement("div",null,!u&&this.renderForm(),!u&&a.a.createElement(O,A({cta:o},this.props)),this.requestState())))}},{key:"cleanFormItemsInState",value:function(){var e=this,t=T({},this.state),n=[];return this.state.formItems.forEach((function(t){var r=t;if(r.label=e.cleanStrings(t.label),r.helpText=e.cleanStrings(t.helpText),r.placeholder=e.cleanStrings(t.placeholder),void 0!==t.options){var a=[];t.options.forEach((function(t){var n=t;n.label=e.cleanStrings(t.label),n.value=e.cleanStrings(t.value),a.push(n)})),r.options=a}n.push(r)})),t.formItems=n,t}},{key:"traverse",value:function(e){var t=this;if(null!==e&&"object"==q(e))return Object.entries(e).forEach((function(e){var n=C(e,2),r=(n[0],n[1]);t.traverse(r)})),e}},{key:"componentDidUpdate",value:function(e,t){var n=this.props.blocks.find((function(e){return"cta"===e.name}))||{cta:null},r=this.state.cta;if(n&&r&&n.cta.link!==r.link){var a=r;a.link=n.cta.link,this.setState({cta:a})}}},{key:"render",value:function(){var e=this.props,t=e.mep,n=e.blocks,r=(e.prefixCss,e.mode,e.onAction,e.ui),o=(e.onSend,this.state),i=o.mepRender,l=o.item,s=o.showSuccessMsg,c=o.openedModal,u=(n.find((function(e){return"title"===e.name}))||{title:null}).title,m=(n.find((function(e){return"description"===e.name}))||{description:null}).description,d=(n.find((function(e){return"cta"===e.name}))||{cta:null}).cta,p=(n.find((function(e){return"msgSuccess"===e.name}))||{msgSuccess:{txt:'<p style="text-align:center;">Votre message a bien été envoyé. Nous y répondrons dès que possible.</p>'}}).msgSuccess;return this.props.integrated?[this.integratedMep(!1,u,m,l,d),a.a.createElement("div",{className:s?"":"d-none",key:"success-msg"},a.a.createElement(z,{contentStyle:{color:"initial",margin:"5rem auto auto auto",background:"none",padding:0,border:0},open:c,onClose:this.closeModal,modal:!0,closeOnDocumentClick:!0},a.a.createElement("div",{className:"modal-content"},a.a.createElement("div",{className:"modal-header border-0 pb-0"},a.a.createElement("button",{type:"button",className:"close",onClick:this.closeModal,"data-dismiss":"modal","aria-label":"Close"},a.a.createElement("span",{"aria-hidden":"true"},"×"))),a.a.createElement("div",{className:"modal-body pt-0"},a.a.createElement("div",null,a.a.createElement("div",{dangerouslySetInnerHTML:{__html:p.txt}}))))))]:[i[t]&&i[t](u,m,r.map&&l,d)||i["stack-reverse"](u,m,r.map&&l,d),a.a.createElement("div",{className:s?"":"d-none",key:"success-msg"},a.a.createElement(z,{contentStyle:{color:"initial",margin:"5rem auto auto auto",background:"none",padding:0,border:0},open:c,onClose:this.closeModal,modal:!0,closeOnDocumentClick:!0},a.a.createElement("div",{className:"modal-content"},a.a.createElement("div",{className:"modal-header border-0 pb-0"},a.a.createElement("button",{type:"button",className:"close",onClick:this.closeModal,"data-dismiss":"modal","aria-label":"Close"},a.a.createElement("span",{"aria-hidden":"true"},"×"))),a.a.createElement("div",{className:"modal-body pt-0"},a.a.createElement("div",null,a.a.createElement("div",{dangerouslySetInnerHTML:{__html:p.txt}}))))))]}}])&&P(t.prototype,n),r&&P(t,r),s}(r.Component));ae.defaultProps={integrated:!1,useOnlyUiTitle:!0,formItems:[],autoAddUi:!0,resourceId:null,addEmail:!0,uiSchema:{Message:{"ui:widget":"textarea"}},url:null,urlSave:null,ui:{label:!0,map:!1,mapFullWdithScreen:!0},schema:{title:"",description:"",type:"object",required:["Email","Message","Nom","Note"],properties:{Nom:{type:"string",title:"Nom",minLength:2},Email:{type:"string",format:"email",title:"Email"},Note:{type:"number",enum:[1,2,3,4,5],title:"Note"},Message:{type:"string",title:"Message",minLength:8}}},onCloseModal:function(){},onAction:function(){},prefixCss:"",mep:"stack-reverse",mode:"view",sectionCss:"",containerCss:"container",bg:{class:"bg-white"},redirection:!1,blocks:[{name:"cta",cta:{txt:"Nous contacter",css:"",class:"btn-primary",link:"/faire-un-site-gratuitement.php",tpl:"BtnBootstrap",visible:!0,icon:{active:!0,css:"far fa-envelope"}}},{name:"title",title:{txt:"<h1>Demande d'informations</h1>",class:"",visible:!1}},{name:"description",description:{txt:"Pour toutes vos questions, veuillez remplir le formulaire ci-dessous"}},{name:"media",item:{src:"https://maps.google.fr/maps?f=q&source=s_q&hl=fr&geocode=&q=paris&output=embed",address:"paris",tpl:"iframe",visible:!1}}],btnAlign:"center",onSend:function(){}};var oe=function(e){var t=e.id,n=e.classNames,r=e.label,o=e.help,i=e.required,l=e.rawErrors,s=e.description,c=(e.errors,e.children),u=e.displayLabel,m=e.hidden,d=e.useOnlyUiTitle?e.uiSchema["ui:title"]:r;return a.a.createElement("div",{className:n+" "},u&&!m&&a.a.createElement("label",{className:"control-label font-weight-bold",htmlFor:t},d,d&&i?"*":null),s,c,l&&l.length>0&&a.a.createElement(ie,{errors:l}),a.a.createElement("small",{className:"form-text text-muted"}," ",o))},ie=function(e){var t=e.errors;return a.a.createElement("ul",{className:"list-unstyled mt-2"},t.map((function(e,t){return a.a.createElement("li",{key:t,className:"text-danger"}," ",a.a.createElement(ce,{msg:e})," ")})))},le=function(e){return a.a.createElement(k.a,{key:"captcha",sitekey:"6LcAZCkUAAAAAJ2XQcVz6M2qgiwypmqhT501lFvv",render:"explicit",hl:"fr",verifyCallback:function(t){(0,e.onChange)(t)},expiredCallback:function(t){(0,e.onChange)(t)}})},se={"is a required property":"Veuillez remplir ce champ",'should match format "email"':"Email non valide","should NOT be shorter than _X_ characters":"Veuillez allonger ce texte pour qu'il comporte au moins _X_ caractères","should NOT be longer than _X_ characters":"Veuillez réduire ce texte à _X_ caractères maximun"},ce=function(e){var t=e.msg,n=t,r=n.match(/\d+/),a=0;return r&&(n=n.replace(r[0],"_X_"),a=r[0]),se[n]?se[n].replace("_X_",a):t};t.default=ae}}]);