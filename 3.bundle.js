(window.webpackJsonp=window.webpackJsonp||[]).push([[3],{667:function(e,o,t){"use strict";t.r(o);var n=t(0),a=t.n(n),r=t(40),s=t(9),l=t.n(s),c=t(30),d=t.n(c),i=[{codeIso:"DE",nom:"Allemagne"},{codeIso:"AT",nom:"Autriche"},{codeIso:"BE",nom:"Belgique"},{codeIso:"CA",nom:"Canada"},{codeIso:"CN",nom:"Chine"},{codeIso:"ES",nom:"Espagne"},{codeIso:"FI",nom:"Finlande"},{codeIso:"FR",nom:"France (Hors DOM TOM)"},{codeIso:"GR",nom:"Grèce"},{codeIso:"IT",nom:"Italie"},{codeIso:"JP",nom:"Japon"},{codeIso:"LU",nom:"Luxembourg"},{codeIso:"NL",nom:"Pays-bas"},{codeIso:"PL",nom:"Pologne"},{codeIso:"PT",nom:"Portugal"},{codeIso:"CZ",nom:"République Tchèque"},{codeIso:"GB",nom:"Royaume-Uni"},{codeIso:"SE",nom:"Suède"},{codeIso:"CH",nom:"Suisse"},{codeIso:"DK",nom:"Danemark"},{codeIso:"US",nom:"Etats-Unis"},{codeIso:"HK",nom:"Hong-Kong"},{codeIso:"NO",nom:"Norvège"},{codeIso:"AU",nom:"Australie"},{codeIso:"SG",nom:"Singapour"},{codeIso:"IE",nom:"Irlande"},{codeIso:"NZ",nom:"Nouvelle-Zélande"},{codeIso:"KR",nom:"Corée du Sud"},{codeIso:"IL",nom:"Israel"},{codeIso:"ZA",nom:"Afrique du Sud"},{codeIso:"NG",nom:"Nigeria"},{codeIso:"CI",nom:"CÃ´te d'Ivoire"},{codeIso:"TG",nom:"Togo"},{codeIso:"BO",nom:"Bolivie"},{codeIso:"MU",nom:"Ile Maurice"},{codeIso:"RO",nom:"Roumanie"},{codeIso:"SK",nom:"Slovaquie"},{codeIso:"DZ",nom:"AlgÃ©rie"},{codeIso:"AS",nom:"Samoa AmÃ©ricaines"},{codeIso:"AD",nom:"Andorre"},{codeIso:"AO",nom:"Angola"},{codeIso:"AI",nom:"Anguilla"},{codeIso:"AG",nom:"Antigua et Barbuda"},{codeIso:"AR",nom:"Argentine"},{codeIso:"AM",nom:"ArmÃ©nie"},{codeIso:"AW",nom:"Aruba"},{codeIso:"AZ",nom:"AzerbaÃ¯djan"},{codeIso:"BS",nom:"Bahamas"},{codeIso:"BH",nom:"BahreÃ¯n"},{codeIso:"BD",nom:"Bangladesh"},{codeIso:"BB",nom:"Barbade"},{codeIso:"BY",nom:"BÃ©larus"},{codeIso:"BZ",nom:"Belize"},{codeIso:"BJ",nom:"BÃ©nin"},{codeIso:"BM",nom:"Bermudes"},{codeIso:"BT",nom:"Bhoutan"},{codeIso:"BW",nom:"Botswana"},{codeIso:"BR",nom:"BrÃ©sil"},{codeIso:"BN",nom:"BrunÃ©i Darussalam"},{codeIso:"BF",nom:"Burkina Faso"},{codeIso:"MM",nom:"Burma (Myanmar)"},{codeIso:"BI",nom:"Burundi"},{codeIso:"KH",nom:"Cambodge"},{codeIso:"CM",nom:"Cameroun"},{codeIso:"CV",nom:"Cap-Vert"},{codeIso:"CF",nom:"Centrafricaine, RÃ©publique"},{codeIso:"TD",nom:"Tchad"},{codeIso:"CL",nom:"Chili"},{codeIso:"CO",nom:"Colombie"},{codeIso:"KM",nom:"Comores"},{codeIso:"CD",nom:"Congo, RÃ©p. DÃ©m."},{codeIso:"CG",nom:"Congo, RÃ©p."},{codeIso:"CR",nom:"Costa Rica"},{codeIso:"HR",nom:"Croatie"},{codeIso:"CU",nom:"Cuba"},{codeIso:"CY",nom:"Chypre"},{codeIso:"DJ",nom:"Djibouti"},{codeIso:"DM",nom:"Dominica"},{codeIso:"DO",nom:"RÃ©publique Dominicaine"},{codeIso:"TL",nom:"Timor oriental"},{codeIso:"EC",nom:"Ã‰quateur"},{codeIso:"EG",nom:"Ã‰gypte"},{codeIso:"SV",nom:"El Salvador"},{codeIso:"GQ",nom:"GuinÃ©e Ã‰quatoriale"},{codeIso:"ER",nom:"Ã‰rythrÃ©e"},{codeIso:"EE",nom:"Estonie"},{codeIso:"ET",nom:"Ã‰thiopie"},{codeIso:"FK",nom:"Falkland,  ÃŽles"},{codeIso:"FO",nom:"FÃ©roÃ©,  ÃŽles"},{codeIso:"FJ",nom:"Fidji"},{codeIso:"GA",nom:"Gabon"},{codeIso:"GM",nom:"Gambie"},{codeIso:"GE",nom:"GÃ©orgie"},{codeIso:"GH",nom:"Ghana"},{codeIso:"GD",nom:"Grenade"},{codeIso:"GL",nom:"Groenland"},{codeIso:"GI",nom:"Gibraltar"},{codeIso:"GP",nom:"Guadeloupe"},{codeIso:"GU",nom:"Guam"},{codeIso:"GT",nom:"Guatemala"},{codeIso:"GG",nom:"Guernesey"},{codeIso:"GN",nom:"GuinÃ©e"},{codeIso:"GW",nom:"GuinÃ©e-Bissau"},{codeIso:"GY",nom:"Guyana"},{codeIso:"HT",nom:"HaÃƒÂ®ti"},{codeIso:"HM",nom:"Heard,  ÃŽle et Mcdonald,  ÃŽles"},{codeIso:"VA",nom:"Saint-Siege (Ã‰tat de la CitÃ© du Vatican)"},{codeIso:"HN",nom:"Honduras"},{codeIso:"IS",nom:"Islande"},{codeIso:"IN",nom:"Inde"},{codeIso:"ID",nom:"IndonÃ©sie"},{codeIso:"IR",nom:"Iran"},{codeIso:"IQ",nom:"Iraq"},{codeIso:"IM",nom:"Man,  ÃŽle de"},{codeIso:"JM",nom:"Jamaique"},{codeIso:"JE",nom:"Jersey"},{codeIso:"JO",nom:"Jordanie"},{codeIso:"KZ",nom:"Kazakhstan"},{codeIso:"KE",nom:"Kenya"},{codeIso:"KI",nom:"Kiribati"},{codeIso:"KP",nom:"CorÃ©e, RÃ©p. Populaire DÃ©m. de"},{codeIso:"KW",nom:"KoweÃ¯t"},{codeIso:"KG",nom:"Kirghizistan"},{codeIso:"LA",nom:"Laos"},{codeIso:"LV",nom:"Lettonie"},{codeIso:"LB",nom:"Liban"},{codeIso:"LS",nom:"Lesotho"},{codeIso:"LR",nom:"LibÃ©ria"},{codeIso:"LY",nom:"Libyenne, Jamahiriya Arabe"},{codeIso:"LI",nom:"Liechtenstein"},{codeIso:"LT",nom:"Lituanie"},{codeIso:"MO",nom:"Macao"},{codeIso:"MK",nom:"MacÃ©doine"},{codeIso:"MG",nom:"Madagascar"},{codeIso:"MW",nom:"Malawi"},{codeIso:"MY",nom:"Malaisie"},{codeIso:"MV",nom:"Maldives"},{codeIso:"ML",nom:"Mali"},{codeIso:"MT",nom:"Malte"},{codeIso:"MH",nom:"Marshall,  ÃŽles"},{codeIso:"MQ",nom:"Martinique"},{codeIso:"MR",nom:"Mauritanie"},{codeIso:"HU",nom:"Hongrie"},{codeIso:"YT",nom:"Mayotte"},{codeIso:"MX",nom:"Mexique"},{codeIso:"FM",nom:"MicronÃ©sie"},{codeIso:"MD",nom:"Moldova"},{codeIso:"MC",nom:"Monaco"},{codeIso:"MN",nom:"Mongolie"},{codeIso:"ME",nom:"MontÃ©nÃ©gro"},{codeIso:"MS",nom:"Montserrat"},{codeIso:"MA",nom:"Maroc"},{codeIso:"MZ",nom:"Mozambique"},{codeIso:"NA",nom:"Namibie"},{codeIso:"NR",nom:"Nauru"},{codeIso:"NP",nom:"NÃ©pal"},{codeIso:"AN",nom:"Antilles NÃ©erlandaises"},{codeIso:"NC",nom:"Nouvelle-CalÃ©donie"},{codeIso:"NI",nom:"Nicaragua"},{codeIso:"NE",nom:"Niger"},{codeIso:"NU",nom:"NiuÃ©"},{codeIso:"NF",nom:"Norfolk,  ÃŽle"},{codeIso:"MP",nom:"Mariannes du Nord,  ÃŽles"},{codeIso:"OM",nom:"Oman"},{codeIso:"PK",nom:"Pakistan"},{codeIso:"PW",nom:"Palaos"},{codeIso:"PS",nom:"Palestinien OccupÃ©, Territoire"},{codeIso:"PA",nom:"Panama"},{codeIso:"PG",nom:"Papouasie-Nouvelle-GuinÃ©e"},{codeIso:"PY",nom:"Paraguay"},{codeIso:"PE",nom:"PÃ©rou"},{codeIso:"PH",nom:"Philippines"},{codeIso:"PN",nom:"Pitcairn"},{codeIso:"PR",nom:"Porto Rico"},{codeIso:"QA",nom:"Qatar"},{codeIso:"RE",nom:"RÃ©union,  ÃŽle de la"},{codeIso:"RU",nom:"Russie, FÃ©dÃ©ration de"},{codeIso:"RW",nom:"Rwanda"},{codeIso:"BL",nom:"Saint-BarthÃ©lemy"},{codeIso:"KN",nom:"Saint-Kitts-et-Nevis"},{codeIso:"LC",nom:"Sainte-Lucie"},{codeIso:"MF",nom:"Saint-Martin"},{codeIso:"PM",nom:"Saint-Pierre-et-Miquelon"},{codeIso:"VC",nom:"Saint-Vincent-et-Les Grenadines"},{codeIso:"WS",nom:"Samoa"},{codeIso:"SM",nom:"Saint-Marin"},{codeIso:"ST",nom:"Sao TomÃ©-et-Principe"},{codeIso:"SA",nom:"Arabie Saoudite"},{codeIso:"SN",nom:"SÃ©nÃ©gal"},{codeIso:"RS",nom:"Serbie"},{codeIso:"SC",nom:"Seychelles"},{codeIso:"SL",nom:"Sierra Leone"},{codeIso:"SI",nom:"SlovÃ©nie"},{codeIso:"SB",nom:"Salomon,  ÃŽles"},{codeIso:"SO",nom:"Somalie"},{codeIso:"GS",nom:"GÃ©orgie du Sud et les  ÃŽles Sandwich du Sud"},{codeIso:"LK",nom:"Sri Lanka"},{codeIso:"SD",nom:"Soudan"},{codeIso:"SR",nom:"Suriname"},{codeIso:"SJ",nom:"Svalbard et  ÃŽle Jan Mayen"},{codeIso:"SZ",nom:"Swaziland"},{codeIso:"SY",nom:"Syrienne"},{codeIso:"TW",nom:"TaÃ¯wan"},{codeIso:"TJ",nom:"Tadjikistan"},{codeIso:"TZ",nom:"Tanzanie"},{codeIso:"TH",nom:"ThaÃ¯lande"},{codeIso:"TK",nom:"Tokelau"},{codeIso:"TO",nom:"Tonga"},{codeIso:"TT",nom:"TrinitÃ©-et-Tobago"},{codeIso:"TN",nom:"Tunisie"},{codeIso:"TR",nom:"Turquie"},{codeIso:"TM",nom:"TurkmÃ©nistan"},{codeIso:"TC",nom:"Turks et Caiques,  ÃŽles"},{codeIso:"TV",nom:"Tuvalu"},{codeIso:"UG",nom:"Ouganda"},{codeIso:"UA",nom:"Ukraine"},{codeIso:"AE",nom:"Ã‰mirats Arabes Unis"},{codeIso:"UY",nom:"Uruguay"},{codeIso:"UZ",nom:"OuzbÃ©kistan"},{codeIso:"VU",nom:"Vanuatu"},{codeIso:"VE",nom:"Venezuela"},{codeIso:"VN",nom:"Vietnam"},{codeIso:"VG",nom:" ÃŽles Vierges Britanniques"},{codeIso:"VI",nom:" ÃŽles Vierges des Ã‰tats-Unis"},{codeIso:"WF",nom:"Wallis et Futuna"},{codeIso:"EH",nom:"Sahara Occidental"},{codeIso:"YE",nom:"YÃ©men"},{codeIso:"ZM",nom:"Zambie"},{codeIso:"ZW",nom:"Zimbabwe"},{codeIso:"AL",nom:"Albanie"},{codeIso:"AF",nom:"Afghanistan"},{codeIso:"AQ",nom:"Antarctique"},{codeIso:"BA",nom:"Bosnie-HerzÃ©govine"},{codeIso:"BV",nom:"Bouvet,  ÃŽle"},{codeIso:"IO",nom:"OcÃ©an Indien, Territoire Britannique de L'"},{codeIso:"BG",nom:"Bulgarie"},{codeIso:"KY",nom:"CaÃ¯mans,  ÃŽles"},{codeIso:"CX",nom:"Christmas,  ÃŽle"},{codeIso:"CC",nom:"Cocos (Keeling),  ÃŽles"},{codeIso:"CK",nom:"Cook,  ÃŽles"},{codeIso:"GF",nom:"Guyane FranÃ§aise"},{codeIso:"PF",nom:"PolynÃ©sie FranÃ§aise"},{codeIso:"TF",nom:"Terres Australes FranÃ§aises"},{codeIso:"AX",nom:"Ãƒâ€¦land,  ÃŽles"}];function m(e){var o=i.find((function(o){return o.codeIso===e}));return o?o.nom:""}function u(e,o){if(null!=e){var t=0==o?6:2;return parseFloat(e).toFixed(t)}}function I(e){return(I="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function f(e,o){for(var t=0;t<o.length;t++){var n=o[t];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function p(e,o){return(p=Object.setPrototypeOf||function(e,o){return e.__proto__=o,e})(e,o)}function y(e){var o=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var t,n=E(e);if(o){var a=E(this).constructor;t=Reflect.construct(n,arguments,a)}else t=n.apply(this,arguments);return v(this,t)}}function v(e,o){return!o||"object"!==I(o)&&"function"!=typeof o?b(e):o}function b(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function E(e){return(E=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function g(e,o,t){return o in e?Object.defineProperty(e,o,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[o]=t,e}var h=t(56),S=function(e){!function(e,o){if("function"!=typeof o&&null!==o)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(o&&o.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),o&&p(e,o)}(s,e);var o,t,n,r=y(s);function s(e){var o;return function(e,o){if(!(e instanceof o))throw new TypeError("Cannot call a class as a function")}(this,s),g(b(o=r.call(this,e)),"filterTxt",(function(e){var o=e,t=document.createElement("div");return t.innerHTML=o,t.textContent||t.innerText||""})),g(b(o),"createPDF",(function(){var e=o.props,t=e.hasLogo,n=e.infosLegales,a=e.msg_tva,r=e.theFacture,s=e.prefixFacture,l=o.state.imgBase64,c=!r.taxable,d=(r.paid?"facture":"bon_commande")+"_"+(s+r.number)+"_"+"".concat(h().format("DD_MM_YYYY")),i=19,u=19,I=new window.jsPDF,f=document.getElementById("basic-table"),p=(I.autoTableHtmlToJson(f),!!t),y=l,v=o.filterTxt(n).split(/\r\n|\r|\n/),b=v.length;I.setFontSize(11),I.setFontStyle("bold");var E=25,g=25;p&&""!=y&&I.addImage(y,"PNG",I.internal.pageSize.width-15-E,i,E,g);var S=3;I.setFontStyle("normal");for(var T=0;T<b;T++)I.text(v[T],15,i+S),S+=5;I.setFontStyle("bold"),u=i+=S>g||!p?S-5:g,I.setFontStyle("bold"),I.text(o.formatTitle(),I.internal.pageSize.width-15,16,"right");var M=u=i+=5;if(I.setDrawColor(238,238,238),I.line(15,M,I.internal.pageSize.width-15,M),r.delivery){I.text("Adresse de livraison :",15,i+=7),I.setFontStyle("normal");var C=r.delivery.address.company_name?r.delivery.address.company_name:"".concat(r.delivery.address.firstname," ").concat(r.delivery.address.name);I.text(C,15,i+=10),I.text("".concat(r.delivery.address.address),15,i+=5),r.delivery.address.address2&&I.text("".concat(r.delivery.address.address2),15,i+=5),I.text("".concat(r.delivery.address.postal_code,", ").concat(r.delivery.address.town),15,i+=5),I.text(m(r.delivery.address.country),15,i+=5)}var N=r.customer.address.company_name?r.customer.address.company_name:"".concat(r.customer.address.firstname," ").concat(r.customer.address.name);I.setFontStyle("bold"),I.text("Adresse de facturation :",I.internal.pageSize.width-15,u+=7,"right"),I.setFontSize(11),I.setFontStyle("normal"),I.text(N,I.internal.pageSize.width-15,u+=10,"right"),I.text("".concat(r.customer.address.address),I.internal.pageSize.width-15,u+=5,"right"),r.customer.address.address2&&I.text(r.customer.address.address2,I.internal.pageSize.width-15,u+=5,"right"),I.text("".concat(r.customer.address.postal_code,", ").concat(r.customer.address.town),I.internal.pageSize.width-15,u+=5,"right");var P=m(r.customer.address.country);I.text(P,I.internal.pageSize.width-(-1===P.indexOf("(")?15:13),u+=5,"right");var w=i>u?i+10:u+10;I.text("Mode de paiement : ".concat(r.paiement.name),15,w),I.text("Date : ".concat(o.formatDate(r.created_at.date)),I.internal.pageSize.width-15,w,"right"),I.autoTable({html:"#basic-table",startY:w+8,showHead:"firstPage",theme:"grid",footStyles:{fillColor:null,textColor:[51,51,51],lineWidth:.1},minCellWidth:"wrap",columnStyles:{0:0==c?{cellWidth:20}:null,1:{cellWidth:70},3:0==c?{cellWidth:10}:null},didParseCell:function(e){"body"===e.row.section&&-1===[0,1].indexOf(e.column.dataKey)&&(e.cell.styles.halign="center"),"foot"===e.row.section&&-1===[0,1].indexOf(e.column.dataKey)&&(e.cell.styles.halign="center")},didDrawCell:function(e){var o=e.column.dataKey===e.table.columns.length-1;if("body"===e.row.section&&o&&e.cell.text[1]){I.setDrawColor("#000000");var t=e.cell.textPos.x-e.table.columns.length-1,n=e.cell.textPos.x+e.table.columns.length+1,a=e.cell.textPos.y+2;I.line(t,a,n,a)}},headStyles:{fillColor:[255,255,255],textColor:[51,51,51],lineWidth:.1},styles:{overflow:"linebreak",valign:"middle"}});var _=I.autoTable.previous.finalY;I.text("",15,_+=5),I.text("".concat(o.filterTxt(a)),15,_+=5),I.save(d)})),o.state={imgBase64:""},o}return o=s,(t=[{key:"formatTitle",value:function(){var e=this.props.theFacture,o=e.paid,t=e.number,n=this.props.prefixFacture;return o?"Facture :"+n+" "+t:"Bon de commande :"+t}},{key:"formatDate",value:function(e){return h(e).format("DD/MM/YYYY à HH:mm")}},{key:"componentDidMount",value:function(){}},{key:"render",value:function(){var e=this.props;return e.hasLogo,e.logo,a.a.createElement("button",{className:"cursor-pt btn btn-primary",id:"download",onClick:this.createPDF},"Télécharger en format PDF")}}])&&f(o.prototype,t),n&&f(o,n),s}(n.Component);S.defaultProps={};var T=S;function M(e){return(M="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function C(e,o){for(var t=0;t<o.length;t++){var n=o[t];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function N(e,o){return(N=Object.setPrototypeOf||function(e,o){return e.__proto__=o,e})(e,o)}function P(e){var o=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var t,n=x(e);if(o){var a=x(this).constructor;t=Reflect.construct(n,arguments,a)}else t=n.apply(this,arguments);return w(this,t)}}function w(e,o){return!o||"object"!==M(o)&&"function"!=typeof o?_(e):o}function _(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function x(e){return(x=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var A=t(56),B=(d.a.CancelToken,l.a._loadScript),k=function(e){!function(e,o){if("function"!=typeof o&&null!==o)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(o&&o.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),o&&N(e,o)}(c,e);var o,t,n,s=P(c);function c(e){var o,t,n,a;return function(e,o){if(!(e instanceof o))throw new TypeError("Cannot call a class as a function")}(this,c),o=s.call(this,e),t=_(o),a=function(e){"edit"===o.props.mode&&e({action:"click_img_logo"})},(n="clickOnLogo")in t?Object.defineProperty(t,n,{value:a,enumerable:!0,configurable:!0,writable:!0}):t[n]=a,o.state={isLoadedJsPdf:!1},o.cfgSite=l.a._store.getConfigSite(),o}return o=c,(t=[{key:"componentWillMount",value:function(){this.loadData()}},{key:"componentDidUpdate",value:function(){}},{key:"loadData",value:function(e){}},{key:"formatDate",value:function(e){return A(e).format("DD/MM/YYYY à HH:mm")}},{key:"componentDidMount",value:function(){"edit"!==this.mode&&this.loadJsPdf()}},{key:"loadJsPdf",value:function(){var e=this;B("https://unpkg.com/jspdf@1.5.3/dist/jspdf.min.js","js","script-jspdf").then((function(){B("https://cdnjs.cloudflare.com/ajax/libs/jspdf-autotable/3.2.4/jspdf.plugin.autotable.min.js","js","script-jspdf-table").then((function(){e.setState({isLoadedJsPdf:!0})}))}))}},{key:"sanitizeDiscounts",value:function(e){var o=[];for(var t in e.items)for(var n in e.items[t].discounts)-1==o.indexOf(e.items[t].discounts[n].id)&&o.push(e.items[t].discounts[n].id);for(var a in e.discounts)o.indexOf(e.discounts[a].id)>-1&&e.discounts.splice(o.indexOf(e.discounts[a].id),1)}},{key:"calculateCoupon",value:function(e){var o,t=0;for(var n in e.items)t+=e.items[n].totalTax;var a={value:0},r=0;e.discounts.length>0&&(a=e.discounts[0])&&(r=a.is_percent?e.subtotal*(a.value/100):a.value);var s=0;return t>0&&(s=a.is_percent?t*(a.value/100):a.value*(t/e.subtotal)),{ttc:r,ht:r-s,tva:s,totalTva:o=t-s,totalHt:e.totalTtc-o}}},{key:"formatPersoLabels",value:function(e,o,t){return a.a.createElement("tr",{key:o},a.a.createElement("td",{scope:"row"},a.a.createElement("small",null,a.a.createElement("b",{dangerouslySetInnerHTML:{__html:e.title}})),a.a.createElement("br",null),a.a.createElement("div",null,a.a.createElement("small",{dangerouslySetInnerHTML:{__html:e.data}}))))}},{key:"renderPersoLabels",value:function(e){var o,t=this;if("product"==e.catalog_item&&Array.isArray(e.metadata)&&e.metadata.length>0)for(var n in e.metadata)void 0!==e.metadata[n].personnalisation_friendly&&(o=a.a.createElement("table",{className:"table"},a.a.createElement("tbody",{className:"results_panier"},e.metadata[n].personnalisation_friendly.map((function(e,o){return t.formatPersoLabels(e,o)})))));return o}},{key:"formatTitle",value:function(){var e=this.props.theFacture,o=e.paid,t=e.number,n=this.props.prefixFacture;return o?"Facture :"+n+" "+t:"Bon de commande :"+t}},{key:"parseNddName",value:function(e){var o="";return e.metadata&&e.metadata.length>0&&void 0!==e.metadata[0].domain_name&&(o=[a.a.createElement("small",{key:"0"},"www. ",e.metadata[0].domain_name),a.a.createElement("br",{key:"1"})]),o}},{key:"render",value:function(){var e=this,o=this.props,t=o.theFacture,n=o.logo,s=o.infosLegales,l=o.cmdCanceled,c=o.cmdPaye,d=o.msg_tva,i=o.mode,I=o.onAction,f=o.prefixFacture,p=this.state.isLoadedJsPdf,y=d,v=s,b=n,E=f;"edit"!==i&&this.cfgSite.global&&(y=this.cfgSite.global.msg_tva||"",v=this.cfgSite.global.infosLegales||"",b=this.cfgSite.global.logo,E=this.cfgSite.global.prefixFacture||"");var g=!t.taxable,h={fontSize:"1.5rem"},S="edit"===i,M=!!b,C={img:{path:b},tpl:"img",visible:M};return this.sanitizeDiscounts(t),a.a.createElement("div",{"data-rcpt":"facture"},a.a.createElement("div",{className:"container text-dark bg-white py-2"},a.a.createElement("div",{className:"pdf"},a.a.createElement("div",{className:"row"},l?a.a.createElement("div",{className:"col-sm-12"},a.a.createElement("div",{className:"text-center",style:h},"Commande annulée")):0==c?a.a.createElement("div",{className:"col-sm-12"},a.a.createElement("div",{className:"text-center",style:h},"Commande non payée")):"",a.a.createElement("div",{className:"col-sm-12"},a.a.createElement("div",{className:"invoice-title"},a.a.createElement("div",{className:"text-right",style:h},"Mandat Administratif"==t.paiement.nom&&"Facture Proforma -",a.a.createElement("span",null,a.a.createElement("div",{dangerouslySetInnerHTML:{__html:E}}))),a.a.createElement("div",{className:"row"},a.a.createElement("div",{className:"col-12"},a.a.createElement("div",{className:"media"},a.a.createElement("div",{className:"img-container"},a.a.createElement(r.a,{item:C,style:{maxHeight:"120px"},onAction:function(){return e.clickOnLogo(I)}})),a.a.createElement("div",{className:"media-body ml-2"},a.a.createElement("div",{dangerouslySetInnerHTML:{__html:v}}))))),a.a.createElement("hr",null),a.a.createElement("div",{className:"row"},a.a.createElement("div",{className:"col-sm-6 text-left"},t.delivery&&t.delivery.address&&a.a.createElement("address",null,a.a.createElement("strong",null,"Adresse de livraison :"),a.a.createElement("br",null),t.delivery.address.company_name?a.a.createElement("span",null,t.delivery.address.company_name):a.a.createElement("span",null,t.delivery.address.firstname," ",t.delivery.address.name),a.a.createElement("br",null),t.delivery.address.address,a.a.createElement("br",null),t.delivery.address.address2&&[t.delivery.address.address2,a.a.createElement("br",{key:"1"})],t.delivery.address.postal_code,","," ",t.delivery.address.town,a.a.createElement("br",null),m(t.delivery.address.country),a.a.createElement("br",null),t.delivery.address.mobile&&["mobile: "+t.delivery.address.mobile,a.a.createElement("br",{key:"2"})],t.delivery.address.telephone&&["tel: "+t.delivery.address.telephone,a.a.createElement("br",{key:"3"})])),a.a.createElement("div",{className:"col-sm-".concat(t.delivery?"6":"12"," text-right")},t.customer.address&&a.a.createElement("address",null,a.a.createElement("strong",null,"Adresse de facturation :"),a.a.createElement("br",null),t.customer.address.company_name?a.a.createElement("span",null,t.customer.address.company_name):a.a.createElement("span",null,t.customer.address.firstname," ",t.customer.address.name),a.a.createElement("br",null),t.customer.address.address,a.a.createElement("br",null),t.customer.address.address2&&[t.customer.address.address2,a.a.createElement("br",{key:"1"})],t.customer.address.postal_code,","," ",t.customer.address.town,a.a.createElement("br",null),m(t.customer.address.country),a.a.createElement("br",null),t.customer.address.telephone&&["tel: "+t.customer.address.telephone,a.a.createElement("br",{key:"3"})]))),a.a.createElement("div",{className:"row"},a.a.createElement("div",{className:"col-sm-6"},a.a.createElement("address",null,a.a.createElement("strong",null,"Mode de paiement : "),t.paiement.name," ",a.a.createElement("br",null))),a.a.createElement("div",{className:"col-sm-6 text-right"},a.a.createElement("address",null,a.a.createElement("strong",null,"Date : "),this.formatDate(t.created_at.date),a.a.createElement("br",null))))))),a.a.createElement("div",{className:"row"},a.a.createElement("div",{className:"col-md-12"},a.a.createElement("div",{className:"card"},a.a.createElement("div",{className:"card-header"},a.a.createElement("strong",null," ",this.formatTitle())),a.a.createElement("div",{className:"card-body"},a.a.createElement("div",{className:"table-responsive"},a.a.createElement("table",{id:"basic-table",className:"table"},a.a.createElement("thead",null,a.a.createElement("tr",null,a.a.createElement("th",null,"Référence"),a.a.createElement("th",null,"Produit"),0==g&&a.a.createElement("th",null,"Prix HT "),a.a.createElement("th",null,"Qté"),0==g&&a.a.createElement("th",null,"Tx TVA"),0==g&&a.a.createElement("th",null,"Total TVA"),a.a.createElement("th",null,"Total TTC"))),a.a.createElement("tbody",null,t.items.map((function(o,t){return a.a.createElement("tr",{key:t},a.a.createElement("td",null,o.sku,"delivery"==o.catalog_item&&a.a.createElement("span",null,"Livraison ",a.a.createElement("br",null))),a.a.createElement("td",null,o.name,a.a.createElement("br",null),a.a.createElement("span",null,e.parseNddName(o)),o.promos.map((function(e,o){return a.a.createElement("span",{key:o,className:"badge badge-primary"},a.a.createElement("small",null,"PROMO -",u(e.value,g),1==e.is_percent?"%":e.currency))})),a.a.createElement("br",null),o.discounts.map((function(e,o){return a.a.createElement("span",{key:o,className:"badge badge-light"},e.coupon,a.a.createElement("span",null,"-",e.value,1==e.is_percent?"%":e.currency))})),e.renderPersoLabels(o)),0==g&&a.a.createElement("td",null,u(o.totalHt,g)," ",a.a.createElement("br",null)),a.a.createElement("td",null,o.quantity),0==g&&a.a.createElement("td",null,o.taxes.length>0&&a.a.createElement("span",null," ",o.taxes[0].tax_rate," %")),0==g&&a.a.createElement("td",null,a.a.createElement("span",null," ",u(o.totalTax,g)," ")),0==g?a.a.createElement("td",null,u(o.totalTtc,g)," ",a.a.createElement("br",null),(o.discounts.length>0||o.promos.length>0)&&a.a.createElement("span",null,a.a.createElement("del",null,u(o.totalTtcBeforeDiscount,g)))):a.a.createElement("td",null,u(o.totalTtc,g),a.a.createElement("br",null),(o.discounts.length>0||o.promos.length>0)&&a.a.createElement("span",null,a.a.createElement("del",null,u(o.totalTtcBeforeDiscount,g)))))})),t.discounts.map((function(o,n){return a.a.createElement("tr",{key:n},a.a.createElement("td",null,"Coupon",o.sku),a.a.createElement("td",null,o.coupon,a.a.createElement("br",null),a.a.createElement("span",null," ","-",o.value," ",1==o.is_percent?"%":t.currency)),0==g?a.a.createElement("td",null,"-",u(e.calculateCoupon(t).ht,g)):a.a.createElement("td",null),a.a.createElement("td",null,"1"),0==g&&a.a.createElement("td",null),0==g&&a.a.createElement("td",null,a.a.createElement("span",null," ","-",u(e.calculateCoupon(t).tva,g)," ")),a.a.createElement("td",null,"-",u(e.calculateCoupon(t).ttc,g)))}))),a.a.createElement("tfoot",null,a.a.createElement("tr",null,a.a.createElement("td",null),a.a.createElement("td",null,"TOTAL"),0==g&&a.a.createElement("td",null,t.discounts.length>0&&a.a.createElement("span",null,u(this.calculateCoupon(t).totalHt,g)," ",t.currency),0==t.discounts.length&&a.a.createElement("span",null,u(t.totalHt,g)," ",t.currency)),a.a.createElement("td",null),0==g&&a.a.createElement("td",null),0==g&&a.a.createElement("td",null,t.discounts.length>0&&a.a.createElement("span",null,u(this.calculateCoupon(t).totalTva,g)," ",t.currency),0==t.discounts.length&&a.a.createElement("span",null,u(t.totalTtc-t.totalHt,g)," ",t.currency)),a.a.createElement("td",null,u(t.totalTtc,!0)," ",t.currency))))))))),a.a.createElement("div",{className:"row"},a.a.createElement("div",{className:"col-sm-12"},a.a.createElement("address",null,a.a.createElement("br",null),t.delivery&&t.delivery.tracking_code&&a.a.createElement("div",null,a.a.createElement("p",null,""!=t.delivery.tracking_code&&a.a.createElement("span",null,a.a.createElement("strong",null,"Numéro de suivi de colis :",a.a.createElement("br",null)," "),t.delivery.tracking_code,a.a.createElement("br",null)))),a.a.createElement("div",{dangerouslySetInnerHTML:{__html:y}}))))),!S&&p&&a.a.createElement(T,{cmdCanceled:l,theFacture:t,hasLogo:M,infosLegales:v,msg_tva:y,logo:b,prefixFacture:E})))}}])&&C(o.prototype,t),n&&C(o,n),c}(n.Component);k.defaultProps={logo:"",msg_tva:"<p><strong>TVA non applicable, article 293 B du CGI</strong></p>",infosLegales:"<p><em>Informations légales de la boutique non renseignées.</em></p>",prefixFacture:"Bon de commande",prefixClass:"",mode:"view",sectionClassName:"",bg:{class:"bg-white",img:{path:"",class:""}},show_title:!1,master_mode:!1,user_uid:null,step:"final",onAction:function(){}};o.default=k}}]);